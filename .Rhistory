geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(INJURIES>200) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(INJURIES>200)
a %>% filter(INJURIES>200) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(PROPDMG>200) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=PROPDMG)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(PROPDMG, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(PROPDMG>20000000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=PROPDMG)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(PROPDMG, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(PROPDMG>2000000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=PROPDMG)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(PROPDMG, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(PROPDMG>200000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=PROPDMG)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(PROPDMG, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=PROPDMG)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(PROPDMG, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(PROPDMG, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(CROPDMG>1000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(CROPDMG>2000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(CROPDMG>3000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(CROPDMG>4000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "INJURIES")
a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES)) %>% arrange(-FATALITIES) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(x="Year",
y = "FATALITIES AND INJURIES",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=sum(PROPDMG),
CROPDMG=sum(CROPDMG)) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(x="Year",
y = "FATALITIES AND INJURIES",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=(sum(PROPDMG)/1000),
CROPDMG=sum(CROPDMG)/1000) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(x="Year",
y = "FATALITIES AND INJURIES",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=(sum(PROPDMG)/100),
CROPDMG=sum(CROPDMG)/100) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(x="Year",
y = "FATALITIES AND INJURIES",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=(sum(PROPDMG)/10),
CROPDMG=sum(CROPDMG)/10) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(x="Year",
y = "FATALITIES AND INJURIES",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=(sum(PROPDMG)/10),
CROPDMG=sum(CROPDMG)/10) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(Title="The most damaging and economically costly weather events in the United States (1950-2011)",
x="Year",
y = "Fatalities, injures, property damage and crop damage",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
data %>% filter(EVTYPE %in% c("TORNADO","EXCESSIVE HEAT","FLASH FLOOD",
"FLOOD","TSTM WIND",
"HAIL")) %>%
group_by(EVTYPE,BGN_YEAR) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=(sum(PROPDMG)/10),
CROPDMG=sum(CROPDMG)/10) %>%
gather(key = "type", value = "value", -EVTYPE,-BGN_YEAR) %>%
ggplot(aes( x = BGN_YEAR, y =value, fill = type, color = type)) + facet_wrap(~EVTYPE) +
geom_line() + theme_bw() +
labs(title="The most damaging and economically costly weather events in the United States (1950-2011)",
x="Year",
y = "Fatalities, injures, property damage and crop damage",
caption = "National Climatic Data Center Storm Events") +
theme(legend.position = "bottom")
## Preguntas
#* Does the analysis address the question of which types of events are most harmful to population health?
data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=sum(PROPDMG),
CROPDMG=sum(CROPDMG),
MAG=sum(MAG)) %>% arrange(-FATALITIES)
## Preguntas
#* Does the analysis address the question of which types of events are most harmful to population health?
data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=sum(PROPDMG),
CROPDMG=sum(CROPDMG)) %>% arrange(-FATALITIES,
-INJURIES,
-PROPDMG,
-CROPDMG)
library(ggpubr)
a<-data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),
INJURIES=sum(INJURIES),
PROPDMG=sum(PROPDMG),
CROPDMG=sum(CROPDMG),
MAG=sum(MAG)) %>% arrange(-FATALITIES)
g1<-a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "FATALITIES")
g2<-a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "INJURIES")
g3<-a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities by type of event",
x="EVTYPE",
y = "PROPDMG")
g4<-a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries by type of event",
x="EVTYPE",
y = "CROPDMG")
ggarrange(g1,g2,g3,g4,ncol = 2)
ggarrange(g1,g2,g3,g4,ncol = 2,nrow = 2)
g5<-ggarrange(g1,g2,g3,g4,ncol = 2,nrow = 2)
annotate_figure(g5, bottom = text_grob("National Climatic Data Center Storm Events",
hjust = 1, x = 1, face = "italic", size = 10))
g1<-a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Fatalities",
x="EVTYPE",
y = "FATALITIES")
g2<-a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Injuries",
x="EVTYPE",
y = "INJURIES")
g3<-a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Property damage",
x="EVTYPE",
y = "PROPDMG")
g4<-a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Crop damage",
x="EVTYPE",
y = "CROPDMG")
g5<-ggarrange(g1,g2,g3,g4,ncol = 2,nrow = 2)
annotate_figure(g5, top=text_grob("The most damaging and economically costly weather events in the United States (1950-2011)"),
bottom = text_grob("National Climatic Data Center Storm Events",
hjust = 1, x = 1, face = "italic", size = 10))
a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Crop damage",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=0,
colour = "black", size=3.0) +
labs(title="Crop damage",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.1,
colour = "black", size=3.0) +
labs(title="Crop damage",
x="EVTYPE",
y = "CROPDMG")
a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="red", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Fatalities",
x="EVTYPE",
y = "FATALITIES")
a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="purple", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Injuries",
x="EVTYPE",
y = "INJURIES")
g1<-a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="red", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Fatalities",
x="EVTYPE",
y = "FATALITIES")
g2<-a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="purple", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Injuries",
x="EVTYPE",
y = "INJURIES")
g3<-a %>% filter(PROPDMG>20000) %>% ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="black", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Property damage",
x="EVTYPE",
y = "PROPDMG")
g4<-a %>% filter(CROPDMG>5000) %>% ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.1,
colour = "black", size=3.0) +
labs(title="Crop damage",
x="EVTYPE",
y = "CROPDMG")
g5<-ggarrange(g1,g2,g3,g4,ncol = 2,nrow = 2)
annotate_figure(g5, top=text_grob("The most damaging and economically costly weather events in the United States (1950-2011)"),
bottom = text_grob("National Climatic Data Center Storm Events",
hjust = 1, x = 1, face = "italic", size = 10))
a %>% filter(PROPDMG>20000) %>% mutate(PROPDMG=PROPDMG/10) %>%
ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="black", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Property damage (divided into 10)",
x="EVTYPE",
y = "PROPDMG")
g1<-a %>% filter(FATALITIES>200) %>% ggplot(aes(x=reorder(EVTYPE,FATALITIES), y=FATALITIES)) +
geom_bar(stat="identity", fill="red", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(FATALITIES, big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Fatalities",
x="EVTYPE",
y = "FATALITIES")
g2<-a %>% filter(INJURIES>1000) %>% ggplot(aes(x=reorder(EVTYPE,INJURIES), y=INJURIES)) +
geom_bar(stat="identity", fill="purple", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(INJURIES, big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Injuries",
x="EVTYPE",
y = "INJURIES")
g3<-a %>% filter(PROPDMG>20000) %>% mutate(PROPDMG=PROPDMG/10) %>%
ggplot(aes(x=reorder(EVTYPE,PROPDMG), y=round(PROPDMG))) +
geom_bar(stat="identity", fill="black", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(PROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.1, colour = "black", size=3.0) +
labs(title="Property damage (divided into 10)",
x="EVTYPE",
y = "PROPDMG")
g4<-a %>% filter(CROPDMG>5000) %>% mutate(CROPDMG=CROPDMG/10) %>%
ggplot(aes(x=reorder(EVTYPE,CROPDMG), y=round(CROPDMG))) +
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(round(CROPDMG), big.mark = ",", scientific = FALSE)), hjust=-0.1,
colour = "black", size=3.0) +
labs(title="Crop damage (divided into 10)",
x="EVTYPE",
y = "CROPDMG")
g5<-ggarrange(g1,g2,g3,g4,ncol = 2,nrow = 2)
annotate_figure(g5, top=text_grob("The most damaging and economically costly weather events in the United States (1950-2011)"),
bottom = text_grob("National Climatic Data Center Storm Events",
hjust = 1, x = 1, face = "italic", size = 10))
